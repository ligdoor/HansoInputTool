<Window x:Class="HansoInputTool.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:behaviors="clr-namespace:HansoInputTool.Behaviors"
        xmlns:messaging="clr-namespace:HansoInputTool.Messaging"
        xmlns:converters="clr-namespace:HansoInputTool.Converters"
        mc:Ignorable="d"
        Title="搬送実績入力ツール" Height="830" Width="850" MinHeight="700" MinWidth="800">

    <Window.Resources>
        <converters:BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <Style x:Key="PlaceholderTextBlockStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource SubTextBrush}"/>
            <Setter Property="Margin" Value="8,0,0,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="IsHitTestVisible" Value="False"/>
        </Style>
    </Window.Resources>

    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction Command="{Binding OnLoadedCommand}"/>
        </i:EventTrigger>
        <i:EventTrigger EventName="Closing">
            <i:InvokeCommandAction Command="{Binding OnClosingCommand}" PassEventArgsToCommand="True"/>
        </i:EventTrigger>

        <!-- ViewModelからのFocusMessageを購読し、フォーカスを当てる -->
        <messaging:MessageTrigger MessageType="{x:Type messaging:FocusMessage}">
            <messaging:FocusAction/>
        </messaging:MessageTrigger>
    </i:Interaction.Triggers>

    <Grid Background="{StaticResource BgBrush}">
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <DockPanel Grid.Row="0" Margin="0,0,0,10">
                <TextBlock Text="搬送実績入力ツール" FontSize="16" FontWeight="Bold" VerticalAlignment="Center"/>
                <Button DockPanel.Dock="Right" Content="⚙️ 設定" Command="{Binding OpenSettingsCommand}" Style="{StaticResource NormalButton}" Background="Transparent" Foreground="{StaticResource SubTextBrush}" Width="57" Margin="630,0,0,0"/>
            </DockPanel>

            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,10">
                <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,0,8,0">
                    <Grid>
                        <StackPanel Orientation="Horizontal" Margin="8,6">
                            <Label Content="期" Padding="0" VerticalAlignment="Center"/>
                            <Grid Margin="6,0,0,0">
                                <TextBox x:Name="PeriodTextBox" Text="{Binding Period, UpdateSourceTrigger=PropertyChanged}" Width="50" Padding="5,2" BorderThickness="0" Background="Transparent">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EnterKeyTraversalBehavior/>
                                    </i:Interaction.Behaviors>
                                </TextBox>
                                <TextBlock>
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                            <Setter Property="Text" Value="例:46"/>
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Text, ElementName=PeriodTextBox}" Value="">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style></TextBlock>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
                <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,0,8,0">
                    <Grid>
                        <StackPanel Orientation="Horizontal" Margin="8,6">
                            <Label Content="月" Padding="0" VerticalAlignment="Center"/>
                            <Grid Margin="6,0,0,0">
                                <TextBox x:Name="MonthTextBox" Text="{Binding Month, UpdateSourceTrigger=PropertyChanged}" Width="40" Padding="5,2" BorderThickness="0" Background="Transparent">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EnterKeyTraversalBehavior/>
                                    </i:Interaction.Behaviors>
                                </TextBox>
                                <TextBlock>
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                            <Setter Property="Text" Value="例:04"/>
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Text, ElementName=MonthTextBox}" Value="">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style></TextBlock>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
                <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,0,8,0">
                    <Grid>
                        <StackPanel Orientation="Horizontal" Margin="8,6">
                            <Label Content="R" Padding="0" VerticalAlignment="Center"/>
                            <Grid Margin="6,0,0,0">
                                <TextBox x:Name="RNumberTextBox" Text="{Binding RNumber, UpdateSourceTrigger=PropertyChanged}" Width="40" Padding="5,2" BorderThickness="0" Background="Transparent">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EnterKeyTraversalBehavior/>
                                    </i:Interaction.Behaviors>
                                </TextBox>
                                <TextBlock>
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                            <Setter Property="Text" Value="例:1"/>
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Text, ElementName=RNumberTextBox}" Value="">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style></TextBlock>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
            </StackPanel>

            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="320"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TabControl Grid.Column="0" Margin="0,0,10,0" SelectedIndex="{Binding SelectedTabIndex}">
                    <TabItem Header="通常シート">
                        <StackPanel Margin="10">
                            <ComboBox ItemsSource="{Binding NormalSheets}" SelectedItem="{Binding SelectedNormalSheet}" Margin="0,0,0,10"/>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="日(B)" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="NormalDayTextBox" Text="{Binding NormalDay, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyTraversalBehavior/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:5"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=NormalDayTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="有料キロ(D)" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="NormalYuryoKmTextBox" Text="{Binding NormalYuryoKm, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyTraversalBehavior/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:120.5"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=NormalYuryoKmTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="無料キロ(E)" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="NormalMuryoKmTextBox" Text="{Binding NormalMuryoKm, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyTraversalBehavior/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:10"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=NormalMuryoKmTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="深夜料金(H)" Padding="0,0,0,2" Visibility="{Binding IsOotsukiSheet, Converter={StaticResource BoolToVis}}"/>
                                    <Label Content="深夜時間(K)" Padding="0,0,0,2" Visibility="{Binding IsOotsukiSheet, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}"/>
                                    <Grid>
                                        <TextBox x:Name="NormalLateValueTextBox" Text="{Binding NormalLateValue, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyAndRegisterBehavior Command="{Binding RegisterNormalCommand}"/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock Visibility="{Binding IsOotsukiSheet, Converter={StaticResource BoolToVis}}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:3000"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=NormalLateValueTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                        <TextBlock Visibility="{Binding IsOotsukiSheet, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:90"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=NormalLateValueTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <CheckBox Content="行旅死亡人（基本料半額）" IsChecked="{Binding IsKoryo}" Margin="5,10"/>
                            <Button Content="登録" Command="{Binding RegisterNormalCommand}" HorizontalAlignment="Right" Style="{StaticResource NormalButton}" Height="25" Width="36"/>
                        </StackPanel>
                    </TabItem>
                    <TabItem Header="東日本シート">
                        <StackPanel Margin="10">
                            <ComboBox ItemsSource="{Binding EastSheets}" SelectedItem="{Binding SelectedEastSheet}" Margin="0,0,0,10"/>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="延実働車輌数" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="EastJitsudoTextBox" Text="{Binding EastJitsudo, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyTraversalBehavior/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:12"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=EastJitsudoTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="搬送回数" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="EastHansoTextBox" Text="{Binding EastHanso, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyTraversalBehavior/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:34"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=EastHansoTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="有料キロ数" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="EastYuryoKmTextBox" Text="{Binding EastYuryoKm, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyTraversalBehavior/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:200.0"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=EastYuryoKmTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="無料キロ数" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="EastMuryoKmTextBox" Text="{Binding EastMuryoKm, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyTraversalBehavior/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:15"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=EastMuryoKmTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <Border BorderBrush="{StaticResource InputBorderBrush}" BorderThickness="2" CornerRadius="3" Margin="0,5">
                                <StackPanel Margin="5">
                                    <Label Content="運輸実績" Padding="0,0,0,2"/>
                                    <Grid>
                                        <TextBox x:Name="EastUnsoTextBox" Text="{Binding EastUnso, UpdateSourceTrigger=PropertyChanged}" Padding="5,2" BorderThickness="0" Background="Transparent">
                                            <i:Interaction.Behaviors>
                                                <behaviors:EnterKeyAndRegisterBehavior Command="{Binding RegisterEastCommand}"/>
                                            </i:Interaction.Behaviors>
                                        </TextBox>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock" BasedOn="{StaticResource PlaceholderTextBlockStyle}">
                                                    <Setter Property="Text" Value="例:125000"/>
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Text, ElementName=EastUnsoTextBox}" Value="">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style></TextBlock>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            <DockPanel Margin="0,10,0,0">
                                <TextBlock Text="{Binding EastSheetStatus}" VerticalAlignment="Center" Margin="5,0">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Foreground" Value="{StaticResource SubTextBrush}"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsEastSheetRegistered}" Value="True">
                                                    <Setter Property="Foreground" Value="{StaticResource GreenBrush}"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style></TextBlock>
                                <Button Content="登録" Command="{Binding RegisterEastCommand}" HorizontalAlignment="Right" Style="{StaticResource NormalButton}"/>
                            </DockPanel>
                        </StackPanel>
                    </TabItem>
                </TabControl>
                <Grid Grid.Column="1">
                    <Grid.Style>
                        <Style TargetType="Grid">
                            <Setter Property="Visibility" Value="Visible"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTabIndex}" Value="1">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <DataGrid ItemsSource="{Binding PreviewDataView}" AutoGenerateColumns="False" SelectedItem="{Binding SelectedRow}" CanUserAddRows="False" IsReadOnly="True" SelectionMode="Single">
                        <DataGrid.Resources>
                            <converters:BindingProxy x:Key="Proxy" Data="{Binding}"/>
                        </DataGrid.Resources>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="日" Binding="{Binding B_Day}" Width="50"/>
                            <DataGridTextColumn Header="搬送" Binding="{Binding C_Hanso}" Width="50"/>
                            <DataGridTextColumn Header="有料km" Binding="{Binding D_YuryoKm, StringFormat={}{0:N1}}" Width="*"/>
                            <DataGridTextColumn Header="無料km" Binding="{Binding E_MuryoKm, StringFormat={}{0:N1}}" Width="*"/>
                            <DataGridTextColumn Header="行旅" Binding="{Binding IsKoryoText}" Width="50"/>
                            <DataGridTextColumn Header="深夜料金(円)" Binding="{Binding H_LateFeeOotsuki}" Width="*" Visibility="{Binding Data.IsOotsukiSheet, Source={StaticResource Proxy}, Converter={StaticResource BoolToVis}}"/>
                            <DataGridTextColumn Header="深夜時間(分)" Binding="{Binding K_LateMinutes}" Width="*" Visibility="{Binding Data.IsOotsukiSheet, Source={StaticResource Proxy}, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,0">
                        <Button Content="選択行を編集" Command="{Binding EditRowCommand}" Margin="0,0,5,0" Style="{StaticResource NormalButton}"/>
                        <Button Content="選択行を削除" Command="{Binding DeleteRowCommand}" Background="{StaticResource RedBrush}" Style="{StaticResource NormalButton}" Height="27"/>
                    </StackPanel>
                </Grid>
            </Grid>
            <Grid Grid.Row="3" Margin="0,10,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <TextBox Grid.Row="0" Text="{Binding LogText, Mode=OneWay}" IsReadOnly="True" MinHeight="100" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap" Background="{StaticResource PanelBackgroundBrush}"/>
                <DockPanel Grid.Row="1" Margin="0,10,0,0">
                    <Button Content="転記実行" DockPanel.Dock="Right" Background="{StaticResource GreenBrush}" Command="{Binding TransferCommand}" Style="{StaticResource NormalButton}" Height="27" Width="73"/>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="実績月報を読み込む" Background="#4f46e5" Command="{Binding LoadGeppoFileCommand}" Style="{StaticResource NormalButton}" Width="105"/>
                        <Button Content="入力内容を保存" Background="{StaticResource ButtonSecondaryBgBrush}" Command="{Binding SaveInputCommand}" Margin="5,0,0,0" Style="{StaticResource NormalButton}" Width="85"/>
                    </StackPanel>
                </DockPanel>
            </Grid>
        </Grid>
    </Grid>
</Window>